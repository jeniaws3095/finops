# Advanced FinOps Platform Configuration
# This file contains all configurable parameters for the platform

# AWS Configuration (loaded by main.py and passed to AWSConfig)
aws:
  regions:
    - us-east-1
    - us-west-2
  default_region: us-east-1
  # Optional: uncomment to use a specific profile or IAM role
  # profile_name: my-aws-profile
  # role_arn: arn:aws:iam::123456789012:role/FinOpsRole
  # role_session_name: finops-session

# Service Configuration
services:
  enabled:
    - ec2
    - rds
    - lambda
    - s3
    - ebs
    - elb
    - cloudwatch
  
  # Service-specific thresholds
  thresholds:
    ec2:
      cpu_utilization_threshold: 5.0  # Percentage
      memory_utilization_threshold: 10.0  # Percentage
      network_utilization_threshold: 5.0  # Percentage
      idle_days_threshold: 7  # Days
    
    rds:
      cpu_utilization_threshold: 10.0  # Percentage
      connection_utilization_threshold: 20.0  # Percentage
      idle_days_threshold: 7  # Days
    
    lambda:
      memory_utilization_threshold: 50.0  # Percentage
      duration_efficiency_threshold: 80.0  # Percentage
      invocation_threshold: 10  # Invocations per day
      idle_days_threshold: 30  # Days
    
    s3:
      access_frequency_threshold: 30  # Days since last access
      storage_class_transition_threshold: 90  # Days
      lifecycle_policy_threshold: 365  # Days
    
    ebs:
      iops_utilization_threshold: 10.0  # Percentage
      throughput_utilization_threshold: 10.0  # Percentage
      idle_days_threshold: 7  # Days
    
    elb:
      request_count_threshold: 100  # Requests per day
      target_utilization_threshold: 20.0  # Percentage
      idle_days_threshold: 7  # Days

    cloudwatch:
      alarm_evaluation_periods: 3
      alarm_period_seconds: 300
      metric_retention_days: 7

# Optimization Configuration
optimization:
  # Risk levels for automatic approval
  auto_approve_risk_levels:
    - LOW
  
  # Cost thresholds for different risk levels
  cost_thresholds:
    LOW: 50.0      # USD per month
    MEDIUM: 200.0  # USD per month
    HIGH: 1000.0   # USD per month
    CRITICAL: 5000.0  # USD per month
  
  # Savings thresholds to trigger recommendations
  minimum_savings_threshold: 10.0  # USD per month
  minimum_savings_percentage: 5.0  # Percentage
  
  # ML Right-sizing configuration
  ml_rightsizing:
    minimum_data_points: 168  # Hours (1 week)
    confidence_threshold: 0.8  # 80% confidence
    performance_buffer: 0.1   # 10% performance buffer
    
  # Pricing intelligence configuration
  pricing:
    reserved_instance_commitment_months: 12  # Months
    spot_instance_interruption_tolerance: 0.1  # 10% tolerance
    savings_plans_commitment_months: 12  # Months

# Anomaly Detection Configuration
anomaly_detection:
  # Baseline establishment
  baseline_days: 30  # Days of historical data
  seasonal_adjustment: true
  
  # Detection thresholds
  thresholds:
    cost_spike_percentage: 50.0  # 50% increase
    cost_spike_absolute: 100.0   # USD
    trend_deviation_percentage: 25.0  # 25% deviation
    pattern_deviation_percentage: 30.0  # 30% deviation
  
  # Alert configuration
  alerts:
    enabled: true
    severity_levels:
      LOW: 25.0     # 25% increase
      MEDIUM: 50.0  # 50% increase
      HIGH: 100.0   # 100% increase
      CRITICAL: 200.0  # 200% increase

# Budget Management Configuration
budget_management:
  # Default budget settings
  default_budget_period: 12  # Months
  
  # Alert thresholds (percentage of budget)
  alert_thresholds:
    - 50.0   # 50% of budget
    - 75.0   # 75% of budget
    - 90.0   # 90% of budget
    - 100.0  # 100% of budget
  
  # Forecasting configuration
  forecasting:
    forecast_months: 6  # Months ahead
    confidence_level: 0.95  # 95% confidence
    growth_assumptions:
      default: 0.15  # 15% annual growth
      conservative: 0.05  # 5% annual growth
      aggressive: 0.30  # 30% annual growth
  
  # Approval workflow configuration
  approval_workflows:
    enabled: true
    auto_approve_threshold: 1000.0  # USD
    escalation_timeout_hours: 24  # Hours

# Scheduling Configuration
scheduling:
  # Continuous monitoring
  continuous_monitoring:
    enabled: false
    interval_minutes: 60  # Run every hour
    
  # Daily optimization
  daily_optimization:
    enabled: false
    time: "02:00"  # 2 AM UTC
    
  # Weekly reporting
  weekly_reporting:
    enabled: false
    day: "sunday"  # Day of week
    time: "06:00"  # 6 AM UTC

# Logging Configuration
logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  
  # Log file configuration
  file:
    enabled: true
    path: "advanced_finops.log"
    max_size_mb: 100
    backup_count: 5
  
  # Console logging
  console:
    enabled: true
    format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  
  # Component-specific log levels
  components:
    boto3: WARNING
    botocore: WARNING
    urllib3: WARNING
    requests: WARNING

# Backend API Configuration
backend_api:
  base_url: "http://localhost:5000"
  timeout_seconds: 30
  retry_attempts: 3
  retry_delay_seconds: 1
  
  # Health check configuration
  health_check:
    enabled: true
    timeout_seconds: 5
    retry_attempts: 2

# Safety Configuration
safety:
  # DRY_RUN mode settings (default: false = live mode; set true for safe/no changes)
  dry_run:
    default: false
    confirmation_required: true
    
  # Rollback configuration
  rollback:
    enabled: true
    timeout_minutes: 30
    validation_checks: true
  
  # Operation limits
  limits:
    max_concurrent_operations: 5
    max_resources_per_operation: 100
    operation_timeout_minutes: 60

# Reporting Configuration
reporting:
  # Report generation
  generation:
    enabled: true
    formats:
      - json
      - csv
      - html
    
  # Report retention
  retention:
    days: 90
    max_reports: 1000
  
  # Export configuration
  export:
    enabled: true
    compression: true
    encryption: false

# Notification Configuration
notifications:
  # Email notifications
  email:
    enabled: false
    smtp_server: ""
    smtp_port: 587
    username: ""
    password: ""
    from_address: ""
    to_addresses: []
  
  # Slack notifications
  slack:
    enabled: false
    webhook_url: ""
    channel: "#finops-alerts"
  
  # SNS notifications
  sns:
    enabled: false
    topic_arn: ""
    region: "us-east-1"